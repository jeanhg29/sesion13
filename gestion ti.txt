pom.xml : <project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
<modelVersion>4.0.0</modelVersion>
<groupId>pe.isil.itam</groupId>
<artifactId>gestion-activos-ti</artifactId>
<version>1.0-SNAPSHOT</version>
<packaging>war</packaging>
<properties>
<maven.compiler.source>24</maven.compiler.source>
<maven.compiler.target>24</maven.compiler.target>
<project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
<project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
</properties>
<dependencies>
<dependency>
<groupId>jakarta.platform</groupId>
<artifactId>jakarta.jakartaee-api</artifactId>
<version>10.0.0</version>
<scope>provided</scope>
</dependency>
<!--  https://mvnrepository.com/artifact/jakarta.servlet.jsp.jstl/jakarta.servlet.jsp.jstl-api  -->
<dependency>
<groupId>jakarta.servlet.jsp.jstl</groupId>
<artifactId>jakarta.servlet.jsp.jstl-api</artifactId>
<version>3.0.2</version>
</dependency>
<!--  https://mvnrepository.com/artifact/org.glassfish.web/jakarta.servlet.jsp.jstl  -->
<dependency>
<groupId>org.glassfish.web</groupId>
<artifactId>jakarta.servlet.jsp.jstl</artifactId>
<version>3.0.1</version>
</dependency>
<!--  https://mvnrepository.com/artifact/com.microsoft.sqlserver/mssql-jdbc
        <dependency>
            <groupId>com.microsoft.sqlserver</groupId>
            <artifactId>mssql-jdbc</artifactId>
            <version>13.2.0.jre11</version>
            <scope>provided</scope>
        </dependency> -->
<!--  https://mvnrepository.com/artifact/jakarta.persistence/jakarta.persistence-api  -->
<dependency>
<groupId>jakarta.persistence</groupId>
<artifactId>jakarta.persistence-api</artifactId>
<version>3.1.0</version>
</dependency>
<!--  https://mvnrepository.com/artifact/org.hibernate.orm/hibernate-core  -->
<dependency>
<groupId>org.hibernate.orm</groupId>
<artifactId>hibernate-core</artifactId>
<version>6.4.4.Final</version>
</dependency>
</dependencies>
<build>
<finalName>${project.artifactId}</finalName>
<plugins>
<plugin>
<groupId>org.apache.maven.plugins</groupId>
<artifactId>maven-compiler-plugin</artifactId>
<version>3.13.0</version>
</plugin>
<plugin>
<groupId>org.apache.tomcat.maven</groupId>
<artifactId>tomcat7-maven-plugin</artifactId>
<version>2.2</version>
<configuration>
<url>http://localhost:8080/manager/text</url>
<username>admin</username>
<password>12345</password>
</configuration>
</plugin>
<plugin>
<groupId>org.apache.maven.plugins</groupId>
<artifactId>maven-war-plugin</artifactId>
<version>3.4.0</version>
<configuration>
<failOnMissingWebXml>false</failOnMissingWebXml>
</configuration>
</plugin>
</plugins>
</build>
</project>


main/java/pe/isi/itam/controller : svAvtivos.java :package pe.isil.itam.controller;


import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import pe.isil.itam.dao.ActivoDAO;
import pe.isil.itam.dao.EstadoDAO;
import pe.isil.itam.dao.UsuarioDAO;
import pe.isil.itam.model.Activo;
import pe.isil.itam.model.Estado;
import pe.isil.itam.model.Usuario;


import java.io.IOException;
import java.util.ArrayList;
import java.util.List;


/**
 * Servlet implementation class SvActivos
 */
@WebServlet("/SvActivos")
public class SvActivos extends HttpServlet {
    private static final long serialVersionUID = 1L;


    private ActivoDAO activoDAO;
    private UsuarioDAO usuarioDAO;
    private EstadoDAO estadoDAO;


    /**
     * @see HttpServlet#HttpServlet()
     */
    public SvActivos() {
        super();
        activoDAO = new ActivoDAO();
        usuarioDAO = new UsuarioDAO();
        estadoDAO = new EstadoDAO();
    }


    /**
     * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)
     */
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        List<Activo> listaActivos = activoDAO.getAll();


        request.setAttribute("listaActivos", listaActivos);


        request.getRequestDispatcher("activos.jsp").forward(request, response);
    }


    /**
     * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)
     */
    protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String accion = request.getParameter("accion");


        Activo activo;
        String nombre;
        String tipo;
        String marca;
        String modelo;
        String numSerie;


        Usuario usuario;
        String codigo;


        Estado estado;
        int idEstado;




        if (accion != null) {
            switch (accion) {
                case "crear":
                    //DAO para INSERT
                    nombre = request.getParameter("nombre");
                    tipo = request.getParameter("tipo");
                    marca = request.getParameter("marca");
                    modelo = request.getParameter("modelo");
                    numSerie = request.getParameter("numSerie");


                    idEstado = Integer.parseInt(request.getParameter("estado"));
                    estado = estadoDAO.getById(idEstado);


                    codigo = request.getParameter("codigo");


                    if (codigo.isEmpty()) {
                        usuario = null;
                    }
                    else {
                        usuario = usuarioDAO.getByCodigo(codigo);
                    }


                    activo = new Activo(nombre,tipo,marca,modelo,numSerie,estado,usuario);


                    if (activoDAO.insert(activo)) {
                        System.out.println("Activo creado");
                    }
                    else {
                        System.out.println("Activo no creado");
                    }


                    break;
                case "editar":
                    //DAO para UPDATE
                    break;
                case "eliminar":
                    //DAO para DELETE
                    break;
                default:
                    // Si la acción no es reconocida, maneja el error
                    response.sendError(HttpServletResponse.SC_BAD_REQUEST, "Acción no válida");
                    break;
            }
        }


        response.sendRedirect("SvActivos");


    }




}










SvLogin.java :




 package pe.isil.itam.controller;


import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import jakarta.servlet.http.HttpSession;
import pe.isil.itam.dao.UsuarioDAO;
import pe.isil.itam.model.Usuario;


import java.io.IOException;


@WebServlet("/SvLogin")
public class SvLogin extends HttpServlet {
    private UsuarioDAO usuarioDAO;


    public SvLogin() {
        this.usuarioDAO = new UsuarioDAO();
    }


    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        super.doGet(req, resp);
    }


    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        HttpSession sesion = req.getSession();


        String codigo = req.getParameter("codigo");
        String contrasena = req.getParameter("contrasena");
        String mensaje = "";
        Boolean esValido = false;


        Usuario usuario = usuarioDAO.getByCodigo(codigo);


        if (codigo == null || codigo.isEmpty() || contrasena == null || contrasena.isEmpty() || usuario == null) {
            mensaje = "Debe ingresar valores correctos para usuario y/o contraseña.";
        }
        else {
            if (usuario.getContrasena().equals(contrasena)) {


                esValido = true;
            }


            if (!esValido) {
                mensaje = "Usuario y/o contraseña incorrectos.";
            }
        }


        if(esValido) {
            sesion.setAttribute("usuario", usuario);
            resp.sendRedirect("dashboard.jsp");
        }
        else {
            req.setAttribute("mensajeError", mensaje);
            req.getRequestDispatcher("index.jsp").forward(req, resp);
        }
    }
}
















SvUsuarios.java : 








package pe.isil.itam.controller;


import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import pe.isil.itam.dao.UsuarioDAO;
import pe.isil.itam.model.Usuario;


import java.io.IOException;
import java.util.List;


@WebServlet("/SvUsuarios")
public class SvUsuarios extends HttpServlet {
    private UsuarioDAO usuarioDAO;


    public SvUsuarios() {
        this.usuarioDAO = new UsuarioDAO();
    }


    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        List<Usuario> listaUsuarios = usuarioDAO.getAll();


        req.setAttribute("listaUsuarios", listaUsuarios);


        req.getRequestDispatcher("usuarios.jsp").forward(req, resp);
    }


    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
        String accion = req.getParameter("accion");
        int id;
        String codigo;
        String nombre;
        String apellido;
        String area;
        String contrasena;
        Usuario usuario;




        if (accion != null) {
            switch (accion) {
                case "crear":
                    //DAO para INSERT
                    codigo = req.getParameter("codigo");
                    nombre = req.getParameter("nombre");
                    apellido = req.getParameter("apellido");
                    area = req.getParameter("area");
                    contrasena = req.getParameter("contrasena");


                    usuario = new Usuario(codigo,nombre,apellido,area,contrasena,true);


                    if (usuarioDAO.insert(usuario)) {
                        System.out.println("Usuario creado");
                    }
                    else {
                        System.out.println("Usuario no creado");
                    }


                    resp.sendRedirect("SvUsuarios");


                    break;
                case "vista-editar":
                    //Redirección a la vista editarUsuario.jsp
                    codigo = req.getParameter("codigo");
                    usuario = usuarioDAO.getByCodigo(codigo);
                    req.setAttribute("usuario",usuario);
                    req.getRequestDispatcher("editarUsuario.jsp").forward(req, resp);
                    break;
                case "editar":
                    //DAO para UPDATE
                    id = Integer.parseInt(req.getParameter("id"));
                    nombre = req.getParameter("nombre");
                    apellido = req.getParameter("apellido");
                    area = req.getParameter("area");
                    contrasena = req.getParameter("contrasena");


                    usuario = new Usuario(id,"",nombre,apellido,area,contrasena,true);


                    if (usuarioDAO.update(usuario)) {
                        System.out.println("Usuario editado");
                    }
                    else {
                        System.out.println("Usuario no editado");
                    }


                    resp.sendRedirect("SvUsuarios");
                    break;
                case "eliminar":
                    //DAO para DELETE
                    id = Integer.parseInt(req.getParameter("id"));
                    usuarioDAO.delete(id);


                    resp.sendRedirect("SvUsuarios");
                    break;
                default:
                    // Si la acción no es reconocida, maneja el error
                    resp.sendError(HttpServletResponse.SC_BAD_REQUEST, "Acción no válida");
                    break;
            }
        }
    }
}






dao/ ActivoDAO.java:
 package pe.isil.itam.dao;


import jakarta.persistence.EntityManager;
import jakarta.persistence.TypedQuery;
import pe.isil.itam.model.Activo;
import pe.isil.itam.model.Estado;
import pe.isil.itam.util.JPAUtil;


import java.util.ArrayList;
import java.util.List;


public class ActivoDAO {
    public boolean insert(Activo activo) {
        EntityManager em = JPAUtil.getEntityManager();
        try {
            em.getTransaction().begin();
            em.persist(activo);
            em.getTransaction().commit();
            return true;
        } catch (Exception e) {
            if (em.getTransaction().isActive()) {
                em.getTransaction().rollback();
            }
            e.printStackTrace();
            return false;
        } finally {
            em.close();
        }
    }


    public List<Activo> getAll() {
        EntityManager em = JPAUtil.getEntityManager();
        List<Activo> activos = new ArrayList<>();


        try {
            String jpql = "SELECT a FROM Activo a";
            TypedQuery<Activo> query = em.createQuery(jpql, Activo.class);
            activos = query.getResultList();
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            em.close();
        }


        return activos;
    }


    public Activo getById(int idActivo) {
        EntityManager em = JPAUtil.getEntityManager();
        try {
            Activo activo = em.find(Activo.class, idActivo);
            return activo;
        } catch (Exception e) {
            e.printStackTrace();
            return null;
        } finally {
            em.close();
        }
    }


    public boolean update(Activo activo) {
        EntityManager em = JPAUtil.getEntityManager();


        try {
            em.getTransaction().begin();
            Activo dbActivo = em.find(Activo.class, activo.getIdActivo());


            if (dbActivo != null) {
                dbActivo.setNombre(activo.getNombre());
                dbActivo.setTipo(activo.getTipo());
                dbActivo.setMarca(activo.getMarca());
                dbActivo.setModelo(activo.getModelo());
                dbActivo.setNumSerie(activo.getNumSerie());
                dbActivo.setEstado(activo.getEstado());
                dbActivo.setUsuario(activo.getUsuario());


                em.getTransaction().commit();
                return true;
            } else {
                em.getTransaction().rollback();
                return false;
            }
        } catch (Exception e) {
            if (em.getTransaction().isActive()) {
                em.getTransaction().rollback();
            }
            e.printStackTrace();
            return false;
        } finally {
            em.close();
        }
    }


    public boolean delete(int idActivo) {
        EntityManager em = JPAUtil.getEntityManager();
        try {
            em.getTransaction().begin();
            Activo activo = em.find(Activo.class, idActivo);
            if (activo != null && activo.getEstado().equals("Retirado")) {


                String jpql = "SELECT e FROM Estado e WHERE e.nombre = :nombre";
                TypedQuery<Estado> query = em.createQuery(jpql, Estado.class);
                query.setParameter("nombre", "Dado de baja");
                Estado estadoDeBaja = query.getSingleResult();


                //Otra posible solución
                //EstadoDAO estadoDAO = new EstadoDAO();
                //Estado estadoDeBaja = estadoDAO.getByNombre("Dado de baja");


                activo.setEstado(estadoDeBaja);
                em.getTransaction().commit();
                return true;
            } else {
                em.getTransaction().rollback();
                return false;
            }
        } catch (Exception e) {
            if (em.getTransaction().isActive()) {
                em.getTransaction().rollback();
            }
            e.printStackTrace();
            return false;
        } finally {
            em.close();
        }
    }




}


EstadoDAO.java:package pe.isil.itam.dao;


import jakarta.persistence.EntityManager;
import jakarta.persistence.NoResultException;
import jakarta.persistence.TypedQuery;
import pe.isil.itam.model.Estado;
import pe.isil.itam.util.JPAUtil;


import java.util.ArrayList;
import java.util.List;


public class EstadoDAO {


    public List<Estado> getAll() {
        EntityManager em = JPAUtil.getEntityManager();
        List<Estado> estados = new ArrayList<>();
        try {
            String jpql = "SELECT e FROM Estado e";
            TypedQuery<Estado> query = em.createQuery(jpql, Estado.class);
            estados = query.getResultList();
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            em.close();
        }
        return estados;
    }


    public Estado getById(int idEstado) {
        EntityManager em = JPAUtil.getEntityManager();
        try {
            return em.find(Estado.class, idEstado);
        } catch (Exception e) {
            e.printStackTrace();
            return null;
        } finally {
            em.close();
        }
    }


    public Estado getByNombre(String nombre) {
        EntityManager em = JPAUtil.getEntityManager();
        try {
            String jpql = "SELECT e FROM Estado e WHERE e.nombre = :nom";
            TypedQuery<Estado> query = em.createQuery(jpql, Estado.class);
            query.setParameter("nom", nombre);
            return query.getSingleResult();
        } catch (NoResultException e) {
            return null;
        } catch (Exception e) {
            e.printStackTrace();
            return null;
        } finally {
            em.close();
        }
    }
}




UsuarioDAO.java : package pe.isil.itam.dao;


import jakarta.persistence.EntityManager;
import jakarta.persistence.NoResultException;
import jakarta.persistence.TypedQuery;
import pe.isil.itam.model.Usuario;
import pe.isil.itam.util.JPAUtil;


import java.util.ArrayList;
import java.util.List;


public class UsuarioDAO {
    public boolean insert(Usuario usuario) {
        EntityManager em = JPAUtil.getEntityManager();


        try {
            em.getTransaction().begin();
            em.persist(usuario);
            em.getTransaction().commit();
            return true;
        } catch (Exception e) {
            if (em.getTransaction().isActive()) {
                em.getTransaction().rollback();
            }
            e.printStackTrace();
            return false;
        } finally {
            em.close();
        }
    }


    public List<Usuario> getAll() {
        List<Usuario> usuarios = new ArrayList<>();
        EntityManager em = JPAUtil.getEntityManager();


        try {
            String jpql = "SELECT u FROM Usuario u";


            TypedQuery<Usuario> query = em.createQuery(jpql, Usuario.class);


            usuarios = query.getResultList();
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            em.close();
        }


        return usuarios;
    }


    public Usuario getByCodigo(String codigo) {
        EntityManager em = JPAUtil.getEntityManager();
        Usuario usuario = null;


        try {
            String jpql = "SELECT u FROM Usuario u WHERE u.codigo = :cod";
            TypedQuery<Usuario> query = em.createQuery(jpql, Usuario.class);
            query.setParameter("cod", codigo);
            usuario = query.getSingleResult();
        } catch (NoResultException e){
            return null;
        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            em.close();
        }


        return usuario;
    }


    public boolean update(Usuario usuario) {
        EntityManager em = JPAUtil.getEntityManager();


        try {
            em.getTransaction().begin();


            Usuario dbUsuario = em.find(Usuario.class, usuario.getIdUsuario());


            if (dbUsuario != null) {
                dbUsuario.setNombre(usuario.getNombre());
                dbUsuario.setApellido(usuario.getApellido());
                dbUsuario.setArea(usuario.getArea());
                dbUsuario.setContrasena(usuario.getContrasena());


                em.getTransaction().commit();
                return true;
            } else {
                em.getTransaction().rollback();
                return false;
            }
        } catch (Exception e) {
            if (em.getTransaction().isActive()) {
                em.getTransaction().rollback();
            }
            e.printStackTrace();
            return false;
        } finally {
            em.close();
        }
    }


    public boolean delete(int idUsuario) {
        EntityManager em = JPAUtil.getEntityManager();


        try {
            em.getTransaction().begin();
            Usuario usuario = em.find(Usuario.class, idUsuario);


            if (usuario != null) {
                usuario.setActivo(false);
                em.getTransaction().commit();
            } else {
                em.getTransaction().rollback();
                return false;
            }
        } catch (Exception e) {
            if (em.getTransaction().isActive()) {
                em.getTransaction().rollback();
            }
            e.printStackTrace();
            return false;
        } finally {
            em.close();
        }


        return false;
    }
}






model /


Activo.java:package pe.isil.itam.model;


import jakarta.persistence.*;


@Entity
@Table(name = "activos")
public class Activo {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "id_activo")
    private int idActivo;
    @Column(name = "nombre")
    private String nombre;
    @Column(name = "tipo")
    private String tipo;
    @Column(name = "marca")
    private String marca;
    @Column(name = "modelo")
    private String modelo;
    @Column(name = "numero_serie")
    private String numSerie;
    @ManyToOne
    @JoinColumn(name = "id_estado", nullable = false)
    private Estado estado;
    @ManyToOne
    @JoinColumn(name = "id_usuario")
    private Usuario usuario; //puede ser nulo


    public Activo() {


    }


    public Activo(int id_activo, String nombre, String tipo, String marca, String modelo, String numero_serie, Estado estado,
                  Usuario usuario) {
        this.idActivo = id_activo;
        this.nombre = nombre;
        this.tipo = tipo;
        this.marca = marca;
        this.modelo = modelo;
        this.numSerie = numero_serie;
        this.estado = estado;
        this.usuario = usuario;
    }


    public Activo(int id_activo, String nombre, String tipo, String marca, String modelo, String numero_serie, Estado estado) {
        this.idActivo = id_activo;
        this.nombre = nombre;
        this.tipo = tipo;
        this.marca = marca;
        this.modelo = modelo;
        this.numSerie = numero_serie;
        this.estado = estado;


    }


    public Activo(String nombre, String tipo, String marca, String modelo, String numero_serie, Estado estado, Usuario usuario) {
        this.nombre = nombre;
        this.tipo = tipo;
        this.marca = marca;
        this.modelo = modelo;
        this.numSerie = numero_serie;
        this.estado = estado;
        this.usuario = usuario;
    }


    public int getIdActivo() {
        return idActivo;
    }


    public void setIdActivo(int idActivo) {
        this.idActivo = idActivo;
    }


    public String getNombre() {
        return nombre;
    }


    public void setNombre(String nombre) {
        this.nombre = nombre;
    }


    public String getTipo() {
        return tipo;
    }


    public void setTipo(String tipo) {
        this.tipo = tipo;
    }


    public String getMarca() {
        return marca;
    }


    public void setMarca(String marca) {
        this.marca = marca;
    }


    public String getModelo() {
        return modelo;
    }


    public void setModelo(String modelo) {
        this.modelo = modelo;
    }


    public String getNumSerie() {
        return numSerie;
    }


    public void setNumSerie(String numSerie) {
        this.numSerie = numSerie;
    }


    public Estado getEstado() {
        return estado;
    }


    public void setEstado(Estado estado) {
        this.estado = estado;
    }


    public Usuario getUsuario() {
        return usuario;
    }


    public void setUsuario(Usuario usuario) {
        this.usuario = usuario;
    }
}














Estado.java :


package pe.isil.itam.model;


import jakarta.persistence.*;


@Entity
@Table(name = "estados_activo")
public class Estado {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "id_estado")
    private int idEstado;
    @Column(name = "nombre", unique = true)
    private String nombre;
    @Column(name = "descripcion")
    private String descripcion;


    public Estado() {
    }


    public int getId() {
        return idEstado;
    }


    public void setId(int id) {
        this.idEstado = id;
    }


    public String getNombre() {
        return nombre;
    }


    public void setNombre(String nombre) {
        this.nombre = nombre;
    }


    public String getDescripcion() {
        return descripcion;
    }


    public void setDescripcion(String descripcion) {
        this.descripcion = descripcion;
    }
}






Usuario.java:
package pe.isil.itam.model;


import jakarta.persistence.*;


@Entity
@Table(name = "usuarios")
public class Usuario {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "id_usuario")
    private int idUsuario;
    @Column(name = "codigo", unique = true, nullable = false, length = 8)
    private String codigo;
    @Column(name = "nombre", nullable = false, length = 100)
    private String nombre;
    @Column(name = "apellido", nullable = false, length = 100)
    private String apellido;
    @Column(name = "area", length = 50)
    private String area;
    @Column(name = "contrasena", nullable = false, length = 100)
    private String contrasena;
    @Column(name = "estado_activo", nullable = false)
    private boolean activo;


    public Usuario () {
    }


    public Usuario (String codigo, String nombre, String apellido, String area , String contrasena, boolean activo) {
        this.codigo = codigo;
        this.nombre = nombre;
        this.apellido = apellido;
        this.area = area;
        this.contrasena = contrasena;
        this.activo = activo;
    }


    public Usuario (int idUsuario, String codigo, String nombre, String apellido, String area , String contrasena, boolean activo) {
        this.idUsuario = idUsuario;
        this.codigo = codigo;
        this.nombre = nombre;
        this.apellido = apellido;
        this.area = area;
        this.contrasena = contrasena;
        this.activo = activo;
    }


    public int getIdUsuario() {
        return idUsuario;
    }


    public void setIdUsuario(int idUsuario) {
        this.idUsuario = idUsuario;
    }


    public String getCodigo() {
        return codigo;
    }


    public void setCodigo(String codigo) {
        this.codigo = codigo;
    }


    public String getNombre() {
        return nombre;
    }


    public void setNombre(String nombre) {
        this.nombre = nombre;
    }


    public String getApellido() {
        return apellido;
    }


    public void setApellido(String apellido) {
        this.apellido = apellido;
    }


    public String getArea() {
        return area;
    }


    public void setArea(String area) {
        this.area = area;
    }


    public String getContrasena() {
        return contrasena;
    }


    public void setContrasena(String contrasena) {
        this.contrasena = contrasena;
    }


    public boolean isActivo() {
        return activo;
    }


    public void setActivo(boolean activo) {
        this.activo = activo;
    }
}






util/ ConnectionFactory.java:


package pe.isil.itam.util;


import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;


public class ConnectionFactory {
    //Aquí va el nombre de la BD que estás usando en databaseName. RECUERDA CAMBIARLA!!!
    private static final String JDBC_URL = "jdbc:sqlserver://localhost:1433;databaseName=itam;encrypt=false;trustServerCertificate=true;";
    //Aquí va el us usuario, que debería ser "sa"
    private static final String USER = "sa";
    //Aquí va la contraseña. RECUERDA CAMBIARLA!!!
    private static final String PASSWORD = "sa";


    public static Connection getConnection() throws SQLException {
        return DriverManager.getConnection(JDBC_URL, USER, PASSWORD);
    }
}






JPAUtil.java:


package pe.isil.itam.util;


import jakarta.persistence.EntityManager;
import jakarta.persistence.EntityManagerFactory;
import jakarta.persistence.Persistence;


public class JPAUtil {
    private static final String PERSISTENCE_UNIT_NAME = "gestionActivosPU";
    private static EntityManagerFactory factory;


    private static EntityManagerFactory getFactory() {
        if (factory == null) {
            factory = Persistence.createEntityManagerFactory(PERSISTENCE_UNIT_NAME);
        }
        return factory;
    }


    public static EntityManager getEntityManager() {
        return getFactory().createEntityManager();
    }
}






resources/ import.sql:


-- Inserta usuarios de prueba (Asegúrate de usar nombres de columnas de tu BD, no de Java)
INSERT INTO usuarios (codigo, nombre, apellido, area, contrasena, estado_activo) VALUES ('admin', 'admin', 'admin', 'admin', 'admin', 1);
INSERT INTO usuarios (codigo, nombre, apellido, area, contrasena, estado_activo) VALUES ('drecalde', 'Diego', 'Recalde', 'Sistemas', '123', 1);


-- Inserta los estados obligatorios
INSERT INTO estados_activo (nombre, descripcion) VALUES (N'En Almacén', N'El activo se encuentra operativo y en el almacén.');
INSERT INTO estados_activo (nombre, descripcion) VALUES (N'Asignado', N'El activo se encuentra asignado a un colaborador.');
INSERT INTO estados_activo (nombre, descripcion) VALUES (N'En Mantenimiento', N'El activo se encuentra en mantenimiento preventivo o correctivo.');
INSERT INTO estados_activo (nombre, descripcion) VALUES (N'Retirado', N'El activo ya cumplió con su ciclo de vida y se encuentra en el almacén.');
INSERT INTO estados_activo (nombre, descripcion) VALUES (N'Dado de baja', N'El activo ya no forma parte de la organización, no se encuentra en instalaciones y no es responsabilidad de la misma.');






















META-INF / persistence.xml:
<persistence xmlns="https://jakarta.ee/xml/ns/persistence" version="3.1">
<persistence-unit name="gestionActivosPU" transaction-type="RESOURCE_LOCAL">
<exclude-unlisted-classes>false</exclude-unlisted-classes>
<properties>
<property name="jakarta.persistence.jdbc.driver" value="com.microsoft.sqlserver.jdbc.SQLServerDriver"/>
<property name="jakarta.persistence.jdbc.url" value="jdbc:sqlserver://localhost:1433;databaseName=itam;encrypt=false;trustServerCertificate=true;"/>
<property name="jakarta.persistence.jdbc.user" value="sa"/>
<property name="jakarta.persistence.jdbc.password" value="sa"/>
<property name="hibernate.dialect" value="org.hibernate.dialect.SQLServerDialect"/>
<property name="hibernate.hbm2ddl.auto" value="update"/>
<property name="hibernate.show_sql" value="true"/>
<property name="hibernate.format_sql" value="true"/>
</properties>
</persistence-unit>
</persistence>




webapp / activos.jsp:


<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ page import="java.util.List" %>
<%@ taglib uri="jakarta.tags.core" prefix="c" %>


<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ITAM: Activos</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
</head>
<body>
<div class="container">
        <h1>Activos</h1>
        <table class="table table-striped">
                <tr>
                        <th>ID</th>
                        <th>Nombre</th>
                        <th>Tipo</th>
                        <th>Marca</th>
                        <th>Modelo</th>
                        <th>N° Serie</th>
                        <th>Estado</th>
                        <th>Código Usuario</th>
                        <th>Acciones</th>
                </tr>
                <c:forEach items="${listaActivos}" var="a">
                <tr>
                        <td>${a.idActivo}</td>
                        <td>${a.nombre}</td>
                        <td>${a.tipo}</td>
                        <td>${a.marca}</td>
                        <td>${a.modelo}</td>
                        <td>${a.numSerie}</td>
                        <td>${a.estado.nombre}</td>
                        <td>${a.usuario == null ? 'NO ASIGNADO' : a.usuario.codigo}</td>
                        <td>
                            <div class="contenedor-botones">
                    <form action="SvActivos" method="POST">
                        <input type="hidden" name="accion" value="vista-editar">
                        <input type="hidden" name="codigo" value="${a.idActivo}">
                        <button type="submit" class="btn btn-warning">Editar</button>
                    </form>
                    <form action="SvActivos" method="POST">
                        <input type="hidden" name="accion" value="eliminar">
                        <input type="hidden" name="id" value="${a.idActivo}">
                        <button type="submit" class="btn btn-danger" ${a.estado.equals("Retirado") ? '' : 'disabled'}>Dar de baja</button>
                    </form>
                </div>
                        </td>
                </tr>
                </c:forEach>
        </table>
        <h1>Crea Activo</h1>
        <form action="SvActivos" method="POST">
                <input type="hidden" name="accion" value="crear">
                <p>
                        <label for="nombre" class="form-label">Nombre:</label>
                        <input type="text" name="nombre" id="nombre" class="form-control">
                </p>
                <p>
                        <label for="tipo" class="form-label">Tipo:</label>
                        <input type="text" name="tipo" id="tipo" class="form-control">
                </p>
                <p>
                        <label for="marca" class="form-label">Marca:</label>
                        <input type="text" name="marca" id="marca" class="form-control">
                </p>
                <p>
                        <label for="modelo" class="form-label">Modelo:</label>
                        <input type="text" name="modelo" id="modelo" class="form-control">
                </p>
                <p>
                        <label for="numSerie" class="form-label">N° Serie:</label>
                        <input type="text" name="numSerie" id="numSerie" class="form-control">
                </p>
                <p>
                        <label for="estado" class="form-label">Estado</label>
                        <input type="text" name="estado" id="estado" class="form-control">
                </p>
                <p>
                        <label for="codigo" class="form-label">Código</label>
                        <input type="text" name="codigo" id="codigo" class="form-control">
                </p>
                <button type="submit" class="btn btn-primary my-2">Crear Activo</button>
        </form>
        <br>
        <a href="dashboard.jsp" class="btn btn-primary my-2">Regresar a Dashboard</a>
</div>
</body>
<style>
        table, th, td {
                border: 1px solid black;
                border-collapse: collapse;
        }
        .contenedor-botones {
                display: flex; /* Pone los elementos uno al lado del otro */
                gap: 10px;     /* Añade 10px de espacio entre los elementos del flex */
        }
</style>
</html>








dashboard.jsp:
<%@ page contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib uri="jakarta.tags.core" prefix="c" %>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Dashboard</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
</head>
<body>
    <div class="container">
        <h1>Dashboard de ITAM</h1>
        <h2>Hola, ${usuario.nombre} ${usuario.apellido} ${usuario.area}</h2>
        <p>Este es tu panel de control</p>
        <a class="btn btn-primary my-2" href="SvUsuarios">Gestionar Usuarios</a>
        <a class="btn btn-primary my-2" href="SvActivos">Gestionar Activos</a>
        <a href="SvLogout">Cerrar Sesión</a>
        </div>
</body>
</html>






editarUsuario.jsp:
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib uri="jakarta.tags.core" prefix="c" %>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ITAM: Editar Usuario</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
</head>
<body>
<div class="container">
        <h1>Editar Usuario: ${usuario.codigo}</h1>
        <form action="SvUsuarios" method="POST">
                <input type="hidden" name="accion" value="editar">
                <p>
                        <input type="hidden" name="id" id="id" value="${requestScope.usuario.idUsuario}">
                </p>
                <p>
                        <label class="form-label" for="nombre">Nombre:</label>
                        <input type="text" name="nombre" id="nombre" value="${requestScope.usuario.nombre}" class="form-control">
                </p>
                <p>
                        <label class="form-label" for="apellido">Apellido:</label>
                        <input type="text" name="apellido" id="apellido" value="${requestScope.usuario.apellido}" class="form-control">
                </p>
                <p>
                        <label class="form-label" for="area">Área:</label>
                        <input type="text" name="area" id="area" value="${requestScope.usuario.area}" class="form-control">
                </p>
                <p>
                        <label class="form-label" for="contrasena">Contraseña:</label>
                        <input type="text" name="contrasena" id="contrasena" value="${requestScope.usuario.contrasena}" class="form-control">
                </p>
                <button class="btn btn-primary" type="submit">Editar Usuario</button>
        </form>
</div>
</body>
</html>






















index.jsp:


<%@ page contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ITAM</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
</head>
<body>
<div class="container">
        <h1>Bienvenido a la plataforma ITAM</h1>
        <h2>Iniciar sesión</h2>
        <form action="SvLogin" method="POST" class="form">
                <p>
                        <label for="usuario" class="form-label">Código:</label>
                        <input type="text" name="codigo" id="usuario" class="form-control">
                </p>
                <p>
                        <label for="contrasena" class="form-label">Contraseña:</label>
                        <input type="password" name="contrasena" id="contrasena" class="form-control">
                </p>
                <button class="btn btn-primary" type="submit">Iniciar Sesión</button>
        </form>


        <p style="color:red;">${mensajeError}</p>
</div>
</body>
</html>
























usuarios.jsp:


<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ page import="java.util.List" %>


<%@ taglib uri="jakarta.tags.core" prefix="c" %>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ITAM: Usuarios</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
</head>
<body>
<div class="container">
        <h1>Usuarios</h1>
        <br>
        <table class="table table-striped">
                <tr>
                        <th>ID</th>
                        <th>Codigo</th>
                        <th>Nombre</th>
                        <th>Apellido</th>
                        <th>Área</th>
                        <th>Contraseña</th>
                        <th>Activo</th>
                        <th>Acciones</th>
                </tr>


                <c:forEach items="${listaUsuarios}" var="u">
                <tr>
                        <td>${u.idUsuario}</td>
                        <td>${u.codigo}</td>
                        <td>${u.nombre}</td>
                        <td>${u.apellido}</td>
                        <td>${u.area}</td>
                        <td>${u.contrasena}</td>
                        <td>${u.activo }</td>


                        <td>
                                <div class="contenedor-botones">
                                        <form action="SvUsuarios" method="POST">
                                                <input type="hidden" name="accion" value="vista-editar">
                                                <input type="hidden" name="codigo" value="${u.codigo}">
                                                <button type="submit" class="btn btn-warning">Editar</button>
                                        </form>
                                        <form action="SvUsuarios" method="POST">
                                                <input type="hidden" name="accion" value="eliminar">
                                                <input type="hidden" name="id" value="${u.idUsuario}">
                                                <button type="submit" class="btn btn-danger">Eliminar</button>
                                        </form>
                                </div>
                        </td>


                </tr>
                </c:forEach>


        </table>
        <br>
        <h1>Crear usuario</h1>
        <br>
        <form action="SvUsuarios" method="POST">
                <input type="hidden" name="accion" value="crear">
                <p>
                        <label for="codigo" class="form-label">Código:</label>
                        <input type="text" name="codigo" id="codigo" class="form-control">
                </p>
                <p>
                        <label for="nombre" class="form-label">Nombre:</label>
                        <input type="text" name="nombre" id="nombre" class="form-control">
                </p>
                <p>
                        <label for="apellido" class="form-label">Apellido:</label>
                        <input type="text" name="apellido" id="apellido" class="form-control">
                </p>
                <p>
                        <label for="area" class="form-label">Área:</label>
                        <input type="text" name="area" id="area" class="form-control">
                </p>
                <p>
                        <label for="contrasena" class="form-label">Contraseña:</label>
                        <input type="text" name="contrasena" id="contrasena" class="form-control">
                </p>
                <button type="submit" class="btn btn-primary my-2">Crear Usuario</button>
        </form>
        <br>
        <a href="dashboard.jsp" class="btn btn-primary my-2">Regresar a Dashboard</a>
</div>
</body>
<style>
        table, th, td {
                border: 1px solid black;
                border-collapse: collapse;
        }
        .contenedor-botones {
                display: flex; /* Pone los elementos uno al lado del otro */
                gap: 10px;     /* Añade 10px de espacio entre los elementos del flex */
        }
</style>
</html>